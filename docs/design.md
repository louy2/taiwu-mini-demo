# 游戏设计文档

## 目录

1. [界面设计](#界面设计)
2. [角色属性](#角色属性)
3. [功法系统](#功法系统)
4. [装备系统](#装备系统)
5. [产业系统](#产业系统)
6. [战斗系统](#战斗系统)
7. [存档系统](#存档系统)
8. [术语对照表](#术语对照表)

---

## 界面设计

### 极简夜读 MUD 风格

为了提供沉浸式的文本体验，界面采用"夜读模式"设计。

### 布局结构

| 区域 | 说明 |
|-----|------|
| **顶部状态栏** | 固定2行，显示角色核心属性或战斗状态 |
| **中央日志区** | 占据主要空间，显示滚动事件日志 |
| **底部抽屉** | 默认折叠，展开显示详细面板和操作按钮 |

### 视觉规范

- **背景色**: `#1a1a1a` (深色)
- **字体**: 无衬线字体 (Microsoft YaHei, PingFang SC)
- **设计原则**: 高对比度文字，去除不必要的边框和装饰

### 战斗界面

全屏战斗界面分为三个阶段:
- **prep (准备)**: 显示敌人信息，确认开始
- **active (战斗)**: 实时战斗日志，可跳过
- **result (结算)**: 显示战斗结果和奖励

---

## 角色属性

### 基础属性

6组12项属性，初始值随机 50-60:

| 攻击属性 | 防御属性 | 作用 |
|---------|---------|------|
| 力道 | 卸力 | 命中/化解判定 |
| 精妙 | 拆招 | 命中/化解判定 |
| 迅疾 | 闪避 | 命中/化解判定 |
| 动心 | 守心 | 命中/化解判定 |
| 破体 | 御体 | 外伤计算 |
| 破气 | 御气 | 内伤计算 |

> **注**: 当前版本命中判定仅使用力道/卸力，其他属性为扩展预留。

### 真气系统

- **初始值**: 80
- **最大值**: 280
- **增长**: 通过"运转周天"提升上限

### 真气分配

真气可分配为4种类型，影响属性加成:

| 类型 | 特点 |
|-----|------|
| **摧破** | 强化攻击属性，偏精妙 |
| **轻灵** | 攻防兼备，强化力道和破气 |
| **护体** | 强化防御属性，偏闪避 |
| **奇窍** | 攻防兼备，强化迅疾和破体 |

**便捷操作**:
- **全部分配**: 将剩余真气全部分配给某类型
- **平均分配**: 将剩余真气平均分配给4种类型
- **重置**: 一键重置所有已分配真气

### 内力类型

由装备的内功决定，影响真气分配时的属性加成倍率:

| 类型 | 力道/卸力 | 精妙/拆招 | 迅疾/闪避 | 动心/守心 | 破体/御体 | 破气/御气 |
|-----|:---:|:---:|:---:|:---:|:---:|:---:|
| **金刚** | 5 | 2 | 2 | 3 | 8 | 2 |
| **紫霞** | 2 | 3 | 5 | 2 | 3 | 7 |
| **玄阴** | 2 | 2 | 3 | 5 | 2 | 8 |
| **纯阳** | 3 | 3 | 3 | 3 | 5 | 5 |
| **归元** | 3 | 5 | 2 | 2 | 7 | 3 |
| **混元** | 3 | 3 | 3 | 3 | 5 | 5 |

### 真气分配效果表

| 类型 | 力道 | 精妙 | 迅疾 | 动心 | 破体 | 破气 | 卸力 | 拆招 | 闪避 | 守心 | 御体 | 御气 |
|-----|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| **摧破** | 1 | 6 | 3 | 3 | 1 | 1 | - | - | - | - | - | - |
| **轻灵** | 6 | 3 | 1 | 3 | 3 | 6 | 3 | 6 | 1 | 3 | 3 | 6 |
| **护体** | - | - | - | - | - | - | 1 | 3 | 6 | 3 | 1 | 1 |
| **奇窍** | 3 | 1 | 6 | 3 | 6 | 3 | 6 | 1 | 3 | 3 | 6 | 3 |

### 属性计算公式

```
最终属性 = 基础属性 + 内力倍率 × Σ(真气分配 × 真气类型加成) + 装备加成
```

---

## 功法系统

### 内功

- 决定角色的**内力类型**
- 决定**催破功法**和**护体功法**的装备槽位数量
- 必须装备并"运转周天"后生效

**多内功系统**:
- 可同时装备最多 **3个** 内功
- 槽位数量叠加计算
- 一个内功指定为"激活"状态，决定当前内力类型
- 不可装备重复功法

### 催破功法

- 战斗中自动施展的攻击招式
- 消耗**势**
- 效果：提升当次攻击的属性倍率

### 护体功法

- 受到攻击时自动施展的防御招式
- 消耗**提气**
- 效果：百分比减少受到的伤害

### 获取方式

- 消耗**威望**进行"访名师"随机领悟
- 重复获得同一功法时，该功法等级 +1

---

## 装备系统

### 装备槽位

| 槽位 | 加成属性 |
|-----|---------|
| **武器** | 力道、破体、破气 |
| **护甲** | 卸力、御体、御气 |

### 品阶

| 等级 | 名称 |
|:---:|-----|
| 1 | 凡品 |
| 2 | 良品 |
| 3 | 上品 |
| 4 | 极品 |
| 5 | 绝世 |

### 获取方式

- 消耗**金钱**在市集"淘装备"获得随机装备
- 新获得的装备放入背包
- 重复获得同一装备时计数 +1

---

## 产业系统

### 资源

| 资源 | 来源 | 用途 |
|-----|------|------|
| **金钱** | 市集产出 | 淘装备、扩建市集 |
| **威望** | 祠堂产出 | 访名师、修缮祠堂 |

### 建筑

| 建筑 | 产出 | 升级消耗 |
|-----|------|---------|
| **市集** | 等级 × 100 金钱/月 | 等级 × 500 金钱 |
| **祠堂** | 等级 × 10 威望/月 | 等级 × 50 威望 |

### 月份流转

每次进行"运转周天"操作时:
1. 时间流逝一个月
2. 自动产出对应资源
3. 真气上限增长

### 新手礼包

新存档获得 **1000 金钱** + **1000 威望**

---

## 战斗系统

### 战斗资源

| 资源 | 上限 | 获取方式 | 用途 |
|-----|-----|---------|------|
| **势** | 无上限 | 普通攻击命中 +1 | 施展催破功法 |
| **提气** | 30000 | 每秒恢复 1200 | 施展护体功法 |

### 命中判定

根据进攻方**力道**与防守方**卸力**对比:

```
当 力道 > 卸力: 命中率 = 力道 / 卸力
当 力道 ≤ 卸力: 命中率 = (力道 / 卸力) / 2
```

> 命中率可超过 100%

### 伤害计算

攻击命中后计算伤害，分为**外伤**和**内伤**两部分:

- **基础伤害**: 9
- **内伤比例**: 0% - 100% (由攻击方设定)
- **外伤比例**: 100% - 内伤比例

**外伤**:
```
系数 x = 破体 / 御体
衰减 y = 12.51 / (12.51 + x)
外伤 = 9 × 外伤比例 × x × y
```

**内伤**:
```
系数 x = 破气 / 御气
衰减 y = 12.51 / (12.51 + x)
内伤 = 9 × 内伤比例 × x × y
```

**总伤害** = 外伤 + 内伤

### 受伤标记

- 累计伤害 ≥ **200** 时，获得 1 个受伤标记
- 累计 **12** 个受伤标记 = 失败

### 战斗日志

- 实时滚动显示最近 3 条记录
- 详细战报保留最近 10 场
- 战斗结束日志可点击查看完整战报

---

## 存档系统

- 支持 **3个** 存档槽位
- 支持删除存档
- 旧版本存档自动迁移
- 使用 LocalStorage 持久化

---

## 术语对照表

| 中文术语 | 英文标识 | 说明 |
|---------|---------|------|
| 真气 | qi | 角色能量，可分配提升属性 |
| 势 | shi | 战斗资源，普攻命中获得 |
| 提气 | tiqi | 战斗资源，每秒自动恢复 |
| 金钱 | money | 产业资源，市集产出 |
| 威望 | prestige | 产业资源，祠堂产出 |
| 内功 | internal | 功法类型，决定内力类型 |
| 催破 | destruction | 功法类型，攻击技能 |
| 护体 | protection | 功法类型，防御技能 |
| 力道 | power | 攻击属性，影响命中 |
| 卸力 | parry | 防御属性，影响化解 |
| 破体 | penetration | 攻击属性，影响外伤 |
| 御体 | resistance | 防御属性，减少外伤 |
| 破气 | qiBreach | 攻击属性，影响内伤 |
| 御气 | qiGuard | 防御属性，减少内伤 |
