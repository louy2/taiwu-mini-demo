# 设计文档

## 核心概念

### 属性
1.  **基础属性**:
    *   力道/卸力/破体/御体/破气/御气：初始值在 50-60 之间。
2.  **真气 (Qi)**:
    *   初始值 80，最大值 280。
    *   可以通过“运转周天”提升真气上限。
    *   真气可分配为 **摧破 (Destruction)** 和 **护体 (Protection)**。
3.  **内力类型 (Neili Type)**:
    *   可选类型：金刚、紫霞、玄阴、纯阳、归元、混元。
    *   影响真气分配时的属性加成倍率：

| 类型 | 力道/卸力 | 破体/御体 | 破气/御气 |
| :--- | :--- | :--- | :--- |
| **金刚** | 10 | 16 | 4 |
| **紫霞** | 4 | 6 | 14 |
| **玄阴** | 4 | 4 | 16 |
| **纯阳** | 6 | 10 | 10 |
| **归元** | 6 | 14 | 6 |
| **混元** | 6 | 10 | 10 |

4.  **衍生效能**:
    *   **摧破真气**: 每点提高 (力道, 破体, 破气) * 对应倍率。
    *   **护体真气**: 每点提高 (卸力, 御体, 御气) * 对应倍率。
    *   **最终属性** = 基础属性 + (分配真气 * 对应倍率)。

### 战斗机制

#### 1. 命中判定
根据双方 **最终力道** 与 **最终卸力** 的对比：
*   **当 进攻方力道 > 防守方卸力 时**：
    $$ 命中率 = \frac{进攻方力道}{防守方卸力} $$
*   **当 进攻方力道 \le 防守方卸力 时**：
    $$ 命中率 = \frac{\frac{进攻方力道}{防守方卸力}}{2} $$

#### 2. 伤害计算
攻击命中后，计算实际伤害。伤害分为 **外伤** 和 **内伤** 两部分，由攻击方设定的比例决定。
*   **基础伤害 (Base Damage)**: 固定为 9。
*   **内伤比例 (Internal Ratio)**: $R_{int}$ (0% - 100%)。
*   **外伤比例 (External Ratio)**: $R_{ext} = 1 - R_{int}$。

**外伤部分**:
*   系数 $x_{ext} = \frac{进攻方破体}{防守方御体}$
*   衰减 $y_{ext} = \frac{12.51}{12.51 + x_{ext}}$
*   $伤害_{ext} = 9 \times R_{ext} \times x_{ext} \times y_{ext}$

**内伤部分**:
*   系数 $x_{int} = \frac{进攻方破气}{防守方御气}$
*   衰减 $y_{int} = \frac{12.51}{12.51 + x_{int}}$
*   $伤害_{int} = 9 \times R_{int} \times x_{int} \times y_{int}$

**最终伤害**:
$$ 总伤害 = 伤害_{ext} + 伤害_{int} $$

#### 3. 受伤标记 (Injury Marks)
*   每当 **累积伤害 \ge 身心强健 (200)** 时：
    1.  受击方增加 1 个 **受伤标记**。
    2.  累积伤害减去 200。
*   **失败条件**: 累计获得 12 个受伤标记。

### 成长
*   **运转周天**: 提升 1 点真气（上限 280）。
*   **真气分配**: 玩家需手动将真气分配至“摧破”或“护体”以获得属性加成。
